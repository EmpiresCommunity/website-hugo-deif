---
title: Ежемесячный отчёт о разработке Empires UE4  - Ноябрь 2020
author: RoyAwesome
date: "2020-12-05"
tags: [ "UE4" ]
post_type: UE4
---

## Обновление проекта

Проект заходит на ура! После кратковременного простоя в сентябре мы добились огромного прогресса в ноябре и даже достигли важной цели в нашей разработке… Теперь в Empires UE4 можно играть от начала до конца! Да, можно зайти в игру, поиграть в нее, а затем, как только вы победите, матч закончится, и сервер сменит карту.

Создание игрового цикла было огромной ступенью текущего этапа, и мы находимся на финишной прямой второго этапа. Давайте вспомним содержание второго этапа:



* Игроки могут разделяться на отряды, и все классы реализованы. **(ГОТОВО)**
* Игроки могут выбирать точку спавна (так же спавны могут быть размещены вручную). **(ГОТОВО)**
* Многие из простых навыков, утилит и гранат реализованы. **(ПОЧТИ ГОТОВО)**
* Игроки могут бегать и приседать. **(ГОТОВО)**
* Игроки могут взаимодействовать с контейнерами боеприпасов, чтобы получить боеприпасы. **(НЕ ГОТОВО)**
* У команд есть билеты, и когда одна команда исчерпывает свои билеты, игра заканчивается.. **(ГОТОВО)**

Как вы видите, наш список задач для этого этапа стремительно уменьшается. Вот скриншот всего, что осталось в нашей проектной доске - hacknplan:

{{< image-proc hacknplan.png Resize "400x" >}}



Как только мы завершим эту фазу, скорее всего, мы возьмем короткий промежуток времени на полировку всего, что у нас есть, и приведём игру в приемлемый вид, а затем можем начать некоторые игровые тесты с большим количеством людей! Это, наверное, будет где-то в начале следующего года и мы на это нацелены!

Помимо простого выполнения каждой задачи, мы потратили много времени на обсуждение особенностей геймплея и того, как модернизировать не только внешний вид игры, но ощущения от неё. Мы обсудим оба этих аспекта в обновлениях программирования и искусства, но имейте в виду, что все это - ранняя разработка, и все производится с возможностью изменить все это, если это выйдет нам боком или будет не в стиле Empires. Прошу всех вас быть открытее к этим изменениям и новшествам и быть готовым к возможностям, что есть в UE4!

#### Программирование


### Программирование геймплея - Roy Awesome

Ноябрь был знаменательным месяцем для развития. Я закончил с командами и отрядами примерно в середине месяца и сразу же приступил к работе над игровым циклом. Игровой цикл - это один из элементов, который мы можем получим с возможностями EU4. В Source версии Empires цели игры (сбор ресурсов, сокращение тикетов другой команды, уничтожение их командирской машины) очень жестко закодированы в самой структуре мода. Очень трудно изменить что-либо, к примеру механики уничтожения командирской машины и исчерпывания тикетов.

<video controls>
  <source src="./squadnames.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Создание отряда с кастомным именем_

Для порта UE4 я решил, что жесткое кодирование игры недопустимо. Потребовалось довольно много времени, чтобы разработать техническую систему, которая не попала бы в эту ловушку, но я чувствую, что нашел хороший выход. Игровые режимы и команды в Empires теперь полностью управляются событиями и реагируют на них и даже могут создавать их.

Для демонстрации и первостепенного развития я реализовал "Conquest", игровой режим из Battlefield. Дизайн прост: у обеих команд есть определенное количество тикетов (я пока что оставил 100), и когда одна команда теряет все тикеты, другая команда выигрывает. Тикет вычитается из команды, когда член этой команды возрождается. Этого простого дизайна, достаточно, чтобы продемонстрировать лежащую в основе системы игровых режимов управляемой событиями. Чтобы реализовать это, как я уже упоминал в прошлом месяце, я дал командам компонент системы способностей, или ASC. Каждой команде я дал набор атрибутов, что содержал тикеты этой команды. Я реализовал возможность дать каждой команде, пассивно ждущей события "Respawn", наблюдать, как этот атрибут применяется для изменения тикетов. Когда команда получает событие "Respawn", она проверяет, возродился ли игрок после того, как был убит, игнорируя возрождение и первое появление. Если это допустимое событие для вычитания тикета, оно так и сделает. Когда кол-во тикетов изменяется, то запускается событие для всех слушающих (в данном случае команды и игровой режим), которое говорит: “Эй, мои билеты изменились”. Игровой режим может прослушивать это событие изменения тикетов и следить за его значением. Когда он набирает 10 тикетов, он отправляет в чат сообщение: “{команда} близка к поражению!”, а когда эта команда истрачивает свои тикеты, игра заканчивается и определяется победитель. Для "Conquest" победившей является так команда, которая имеет больше всего тикетов.

Эта система оказалась чрезвычайно успешной в реализации игровых событий и обеспечивала гибкость и легкость модификации, что является одной из основных целей этого проекта. Думаю, многие из вас начинают представлять себе, как будет создан классический игровой режим Empires, прослушивая событие "Техника уничтожена" и заканчивая игру, если эта машина являлось командирской машиной. Я действительно хочу дать возможность мододелам проявить себя в новом Empires, и что бы вы этим наслаждались.

<video controls>
  <source src="./roundend.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Протекание игрового раунда, включая работу в прогрессе. Даже музыка есть!_

Хоть это была большая задача, в этом месяце я сделал еще больше. В ноябре плагин Easy Ballistics был выпущен бесплатно на рынке Unreal Engine Marketplace. Я слышал много хорошего об этом плагине и о том, насколько гибким и функциональным он был, так что у нас есть отличная возможность попробовать реализовать его в Empires и заполучить баллистику для пехоты и техники. Мне потребовалось около 3 часов, чтобы интегрировать его в нашу оружейную систему, так что теперь у нас есть возможность использовать полностью физически смоделированные пули с учетом времени полета, падения пули, рикошета, давления ветра/атмосферы и многого другого. Empires - это чрезвычайно аркадный шутер, поэтому мы, скорее всего, не будем пользоваться многими из этих функций, приятно иметь их для моддеров, и, возможно, мы сможем поэкспериментировать с ними в будущем. Однако время полёта пули и её падение мы точно используем, так как в Empires, пушки имеющие хитскан, являются тем ещё гемороем с балансом пехоты.  

<video controls>
  <source src="./ballistics.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Баллистика с повышенной силой рикошета_

<video controls>
  <source src="./ballistics2.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Балистика с пониженной скоростью пули_

Ещё я начал интегрировать плагин "MoveIt", который представляет собой полупроцедурный анимационный фреймворк для сеток и движений от 3-го лица. Это мощный инструмент для ускорения нашего дальнейшего развития, и его интеграция позволит нам делать довольно много чего крутого, к примеру анимацию поворота на месте, бега, приседания и даже подката "бег в присяди". Это также позволяет нам настроить вес игрока и реализовать инерцию и замедление в движении пехоты. Опять же, как и с баллистикой, мы вряд ли будем использовать все эти функции, но я планирую поэкспериментировать с ними и протестировать их, чтобы увидеть, будут ли они вписываться в концепцию Empires. Я твердо убежден, что движение пехоты - это самое важное в нашей игре, и наличие глубокого и интересного моделирования движения персонажа сделает эту игру чрезвычайно увлекательной. Я уже вижу, как вы постите гифки сверхскоростных минометных дуэлей и подобных, поэтому я хочу сделать их более веселыми и интересными.  

<video controls>
  <source src="./moveit_tip.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Работа в прогрессе. Интеграция "Moveit", с анимацией поворота на месте, приседания и прицеливания. _

<video controls>
  <source src="./moveit_slide.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video> 

_Работа в прогрессе. Интеграция "Moveit", подкаты. Более долгий для демонстрации._

Это был насыщенный месяц для проекта, и следующий месяц будет еще более красочным. Что бы вы знали, попутно, когда я пишу этот раздел, я обновляю Empires до Unreal Engine 4.26. Если взглянете на заметки о патче, вы увидите море новых функций, таких как полноценное моделирование воды и океана, объемность (объемы облаков и тумана), несколько откровенно удивительных инструментов ландшафта и редактирования геометрии. Подумать страшно, что картоделы с этим сделают.  


#### Искусство


### f1r3w4rr10r

И Mayama, и я в настоящее время вкалываем и делаем модели персонажей Северных фракций, так и для Империи Бреноди. Mayama взялся за СФ, а я принялся за Бреноди. Мы хотели сохранить общий дух СФ в основном таким же, и Mayama справился с этим довольно хорошо, одновременно повторяя идеи и двигаясь в новых направлениях. Со своей стороны, я был и остаюсь при своем мнении, что мы должны отойти от концепции Вермахта в сторону чего-то нового. У меня есть приблизительное представление о том, во что это перейдёт, но мои модели все еще находятся в стадии разработки и еще не совсем готовы к показу в обновлении. Однако вы можете мельком увидеть их, когда я буду работать над ними.


### Mayama

Мне наконец-то удалось закончить две высокополигольные модели пехоты СФ. Тяжелый бронированный солдат- стрелок и менее бронированный и проворный - разведчик. Обе модели все еще нуждаются в низкополигональном текстурировании и ригинге, прежде чем их можно будет ввести в игру, но приятно видеть, как все продвигается. Основная идея, лежащая в основе доспехов, заключалась в том, что Северная фракция использует все, что у них есть под рукой, чтобы защитить себя от превосходящей огневой мощи, что обладают силы Бреноди. Это смесь старого промышленного снаряжения, металлических пластин, привязанных к телу, и скрытого военного снаряжения, которое было припрятано с прошлой войны.

{{< image-proc featured.png Resize "1100x" >}}

{{< triple-image-thumbnail "heavy_armor_1.png" "heavy_armor_2.png" "heavy_armor_3.png" >}}
{{< triple-image-thumbnail "heavy_armor_4.png" "heavy_armor_5.png" "heavy_armor_6.png" >}}

{{< image-proc NF_scout_armor_1.png Resize "1100x" >}}

{{< triple-image-thumbnail "scout_armor_1.png" "scout_armor_2.png" "scout_armor_3.png" >}}
{{< triple-image-thumbnail "scout_armor_4.png" "scout_armor_5.png" "scout_armor_6.png" >}}

Я также сделал некоторые инструменты СФ: мины и инженерный инструмент. Я не очень доволен камерой, но я покажу её вам.
(Говорю по секрету: когда Mayаma нам впервые показал камеру, мы подумали, что это переносной сральник :D)

{{< image-proc NF_engi_tool_1.png Resize "1100x" >}}
{{< image-proc NF_camera_1.png Resize "1100x" >}}
{{< image-proc NF_Mine_1.png Resize "1100x" >}}

Вот пример, как эта мягкая броня, скорее всего, будет выглядеть в игре, потому что на фотографиях, которые я разместил, она выглядит как глянцевые подушки. Если бы я уменьшил глянец на фотографиях, вы не смогли бы разглядеть много деталей.

{{< image-proc bags.png Resize "1200x" >}}


----

Играйте в оригинальный Empires в Steam!

{{< rawhtml >}}
<iframe src="https://store.steampowered.com/widget/17740/" frameborder="0" width="646" height="190"></iframe>
{{< /rawhtml >}}

И закатывайтесь к нам в Дискорд!

{{< rawhtml >}}
<iframe src="https://discordapp.com/widget?id=227846801653366784&theme=dark" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>
{{< /rawhtml >}}
